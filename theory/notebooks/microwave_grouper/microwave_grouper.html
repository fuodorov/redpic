<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Microwave grouper &#8212; redpic 0.10.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=a24a0889"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Installation" href="../../../install/installation.html" />
    <link rel="prev" title="Theory" href="../slow_motion_waves/slow_motion_waves.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Microwave-grouper">
<h1>Microwave grouper<a class="headerlink" href="#Microwave-grouper" title="Permalink to this heading">Â¶</a></h1>
<p>The processes of beam bunching in a microwave buncher can be analyzed using the equations of longitudinal dynamics:</p>
<p>Equation for the change in particle momentum</p>
<div class="math notranslate nohighlight">
\[\frac{dp_z}{dt} = eE(z)\cos(\omega t + \phi_0)\]</div>
<p>where <span class="math notranslate nohighlight">\(p_z\)</span> is the longitudinal momentum of the particle, <span class="math notranslate nohighlight">\(e\)</span> is the charge of the electron, <span class="math notranslate nohighlight">\(E(z)\)</span> is the distribution of the magnitude of the longitudinal electric field along the axis of the buncher, <span class="math notranslate nohighlight">\(\omega\)</span> is the angular frequency, and <span class="math notranslate nohighlight">\(\phi_0\)</span> is the initial phase. Taking into account that the longitudinal momentum of a particle is <span class="math notranslate nohighlight">\(\beta\gamma m\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the rest mass of an electron, and <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are the usual
relativistic factors of particles, equation can be rewritten as</p>
<p>Equation for the change in longitudinal phase space</p>
<div class="math notranslate nohighlight">
\[\frac{d(\gamma\beta)}{dt} = \left(\frac{e}{mc}\right)E(z)\cos(\omega t + \phi_0)\]</div>
<p>The derivative $:nbsphinx-math:<cite>frac{dgamma beta}{dt}</cite> = <span class="math">\dot{\gamma}</span><span class="math">\beta `+ :nbsphinx-math:</span>dot{beta}`:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>gamma <a href="#id3"><span class="problematic" id="id4">`</span></a>$, where the dot indicates a derivative with respect to time, can be transformed as follows:</p>
<div class="math notranslate nohighlight">
\[\dot{\gamma} = \frac{d}{dt} \frac{1}{\sqrt{1-\beta^2}} = \beta \gamma^3 \dot{\beta}.\]</div>
<p>Then takes the form:</p>
<div class="math notranslate nohighlight">
\[\frac{d\gamma \beta}{dt} = \gamma \dot{\beta} (\gamma^2 \beta^2 + 1) = \frac{e}{mc} E(z) \cos(\omega t + \varphi_0).\]</div>
<p>If we assume that the longitudinal velocity of the particle is much smaller than the transverse velocity <span class="math notranslate nohighlight">\(\gamma \beta_{\alpha, r} \ll \gamma \beta\)</span>, then <span class="math notranslate nohighlight">\(\gamma^2 = \gamma^2 \beta^2 + 1\)</span>, and transitioning to the longitudinal coordinate <span class="math notranslate nohighlight">\(dt = \frac{dz}{\beta c}\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{d\beta}{dz} \frac{\beta }{(1-\beta^2)^{3/2}} = \frac{E(z)}{U_0} \cos(\varphi + \varphi_0),\]</div>
<p>where <span class="math notranslate nohighlight">\(U_0 = mc^2/e\)</span> - is the rest energy of the electron in volts, <span class="math notranslate nohighlight">\(\varphi\)</span> - is the phase of the moving particle relative to the electrical component of the CBM field:</p>
<div class="math notranslate nohighlight">
\[\frac{d\varphi}{dz} = \frac{\omega}{\beta c}.\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt

# Constants
U0 = 511e3  # Rest energy of the electron in eV (mc^2/e)
c = 3e8  # Speed of light in vacuum (m/s)
omega = 2 * np.pi * 1e9  # Angular frequency (for example, 1 GHz)
f = 1.5 * 1e9  # Frequency
phi_0 = 0  # Initial phase
E0 = -40e6  # Electric field strength in V/m (example value)
dz = 1e-6  # Step size in m
z_max = 0.3  # Length of the buncher in m
num_particles = 1_000  # Number of particles

# Initial conditions
betas = np.full(num_particles, 0.7)  # Initial beta for all particles
phis = np.linspace(0, np.pi, num_particles)  # Uniform distribution of initial phases

# Function to calculate derivatives
def derivatives(beta, phi):
    dbeta_dz = (E0 / U0) * np.cos(phi + phi_0) * ((1 - beta**2)**(3/2)) / beta
    dphi_dz = omega / (beta * c)
    return dbeta_dz, dphi_dz

# Function to calculate Ez(z)
def E_z(z):
    return E0 * np.sin(2 * np.pi * f * z / c + phi_0)

# Solving the system using Euler&#39;s method
z_values = np.arange(0, z_max, dz)
betas_values = []
phis_values = []

for z in z_values:
    dbeta_dz, dphi_dz = derivatives(betas, phis)
    betas += dbeta_dz * dz
    phis += dphi_dz * dz
    betas_values.append(betas.copy())
    phis_values.append(phis.copy())

# Correcting phase to be within [0, 2*pi]
phis = phis % (2 * np.pi)

# Plotting the histogram of particle phases at the output
plt.figure(figsize=(12, 5))
plt.subplot(1, 2, 1)
plt.hist(phis, bins=100, color=&#39;blue&#39;, alpha=0.7)
plt.xlabel(&#39;Phase (rad)&#39;)
plt.ylabel(&#39;Number of Particles&#39;)
plt.title(&#39;Particle Phase Distribution at Microwave Buncher Output&#39;)
plt.grid(True)

# Plotting Ez(z)
Ez_values = E_z(z_values)
plt.subplot(1, 2, 2)
plt.plot(z_values, Ez_values, label=&#39;$E_z(z)$&#39;, color=&#39;red&#39;)
plt.xlabel(&#39;z (m)&#39;)
plt.ylabel(&#39;$E_z$ (V/m)&#39;)
plt.title(&#39;Electric Field Strength Along the Buncher&#39;)
plt.grid(True)
plt.tight_layout()
plt.show()
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
D:\TMP\ipykernel_8688\2113458680.py:21: RuntimeWarning: invalid value encountered in power
  dbeta_dz = (E0 / U0) * np.cos(phi + phi_0) * ((1 - beta**2)**(3/2)) / beta
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/theory_notebooks_microwave_grouper_microwave_grouper_2_1.png" src="../../../_images/theory_notebooks_microwave_grouper_microwave_grouper_2_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">redpic</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../test/test.html">Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance/performance.html">Performance</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../theory.html">Theory</a><ul>
      <li>Previous: <a href="../slow_motion_waves/slow_motion_waves.html" title="previous chapter">Theory</a></li>
      <li>Next: <a href="../../../install/installation.html" title="next chapter">Installation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Vyacheslav Fedorov.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/theory/notebooks/microwave_grouper/microwave_grouper.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>